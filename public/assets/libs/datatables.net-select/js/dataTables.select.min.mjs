/*! For license information please see dataTables.select.min.mjs.LICENSE.txt */
import e from"jquery";import t from"datatables.net";let l=e;function s(e,t,l){function s(t,l){l<t&&(s=l,l=t,t=s);var s,c=!1;return e.columns(":visible").indexes().filter(function(e){return e===t&&(c=!0),e===l?!(c=!1):c})}function c(t,l){var s,c=e.rows({search:"applied"}).indexes(),n=(c.indexOf(t)>c.indexOf(l)&&(s=l,l=t,t=s),!1);return c.filter(function(e){return e===t&&(n=!0),e===l?!(n=!1):n})}var n;l=e.cells({selected:!0}).any()||l?(n=s(l.column,t.column),c(l.row,t.row)):(n=s(0,t.column),c(0,t.row)),l=e.cells(l,n).flatten();e.cells(t,{selected:!0}).any()?e.cells(l).deselect():e.cells(l).select()}function c(e){var t=e.settings()[0]._select.selector;l(e.table().container()).off("mousedown.dtSelect",t).off("mouseup.dtSelect",t).off("click.dtSelect",t),l("body").off("click.dtSelect"+u(e.table().node()))}function n(e){var t,s=l(e.table().container()),c=e.settings()[0],n=c._select.selector;s.on("mousedown.dtSelect",n,function(e){(e.shiftKey||e.metaKey||e.ctrlKey)&&s.css("-moz-user-select","none").one("selectstart.dtSelect",n,function(){return!1}),window.getSelection&&(t=window.getSelection())}).on("mouseup.dtSelect",n,function(){s.css("-moz-user-select","")}).on("click.dtSelect",n,function(s){var c,n=e.select.items();if(t&&((!(i=window.getSelection()).anchorNode||l(i.anchorNode).closest("table")[0]===e.table().node())&&i!==t))return;var a,i=e.settings()[0],r=e.settings()[0].oClasses.sWrapper.trim().replace(/ +/g,".");l(s.target).closest("div."+r)[0]==e.table().container()&&(r=e.cell(l(s.target).closest("td, th"))).any()&&(a=l.Event("user-select.dt"),o(e,a,[n,r,s]),a.isDefaultPrevented()||(a=r.index(),"row"===n?(c=a.row,d(s,e,i,"row",c)):"column"===n?(c=r.index().column,d(s,e,i,"column",c)):"cell"===n&&(c=r.index(),d(s,e,i,"cell",c)),i._select_lastCell=a))}),l("body").on("click.dtSelect"+u(e.table().node()),function(t){var s;!c._select.blurable||l(t.target).parents().filter(e.table().container()).length||0===l(t.target).parents("html").length||l(t.target).parents("div.DTE").length||(s=l.Event("select-blur.dt"),o(e,s,[t.target,t]),s.isDefaultPrevented()||r(c,!0))})}function o(e,t,s,c){c&&!e.flatten().length||("string"==typeof t&&(t+=".dt"),s.unshift(e),l(e.table().node()).trigger(t,s))}function a(e){var s=new t.Api(e);e._select_init=!0,e.aoRowCreatedCallback.push({fn:function(t,s,c){var n,o,a=e.aoData[c];for(a._select_selected&&l(t).addClass(e._select.className),n=0,o=e.aoColumns.length;n<o;n++)(e.aoColumns[n]._select_selected||a._selected_cells&&a._selected_cells[n])&&l(a.anCells[n]).addClass(e._select.className)},sName:"select-deferRender"}),s.on("preXhr.dt.dtSelect",function(e,t){var l,c;t===s.settings()[0]&&(l=s.rows({selected:!0}).ids(!0).filter(function(e){return void 0!==e}),c=s.cells({selected:!0}).eq(0).map(function(e){var t=s.row(e.row).id(!0);return t?{row:t,column:e.column}:void 0}).filter(function(e){return void 0!==e}),s.one("draw.dt.dtSelect",function(){s.rows(l).select(),c.any()&&c.each(function(e){s.cells(e.row,e.column).select()})}))}),s.on("draw.dtSelect.dt select.dtSelect.dt deselect.dtSelect.dt info.dt",function(){(function(e){var t,s,c,n,o=e.settings()[0];o._select.info&&o.aanFeatures.i&&"api"!==e.select.style()&&(t=e.rows({selected:!0}).flatten().length,s=e.columns({selected:!0}).flatten().length,c=e.cells({selected:!0}).flatten().length,n=function(t,s,c){t.append(l('<span class="select-item"/>').append(e.i18n("select."+s+"s",{_:"%d "+s+"s selected",0:"",1:"1 "+s+" selected"},c)))},l.each(o.aanFeatures.i,function(e,o){o=l(o);var a=l('<span class="select-info"/>'),i=(n(a,"row",t),n(a,"column",s),n(a,"cell",c),o.children("span.select-info"));i.length&&i.remove(),""!==a.text()&&o.append(a)}))})(s),s.state.save()}),s.on("destroy.dtSelect",function(){l(s.rows({selected:!0}).nodes()).removeClass(s.settings()[0]._select.className),c(s),s.off(".dtSelect"),l("body").off(".dtSelect"+u(s.table().node()))})}function i(e,t,s,c){var n,o=e[t+"s"]({search:"applied"}).indexes(),a=(c=l.inArray(c,o),l.inArray(s,o));e[t+"s"]({selected:!0}).any()||-1!==c?(a<c&&(n=a,a=c,c=n),o.splice(a+1,o.length),o.splice(0,c)):o.splice(l.inArray(s,o)+1,o.length),e[t](s,{selected:!0}).any()?(o.splice(l.inArray(s,o),1),e[t+"s"](o).deselect()):e[t+"s"](o).select()}function r(e,l){!l&&"single"!==e._select.style||((l=new t.Api(e)).rows({selected:!0}).deselect(),l.columns({selected:!0}).deselect(),l.cells({selected:!0}).deselect())}function d(e,t,l,c,n){var o=t.select.style(),a=t.select.toggleable(),r=t[c](n,{selected:!0}).any();r&&!a||("os"===o?e.ctrlKey||e.metaKey?t[c](n).select(!r):e.shiftKey?"cell"===c?s(t,n,l._select_lastCell||null):i(t,c,n,l._select_lastCell?l._select_lastCell[c]:null):(a=t[c+"s"]({selected:!0}),r&&1===a.flatten().length?t[c](n).deselect():(a.deselect(),t[c](n).select())):"multi+shift"==o&&e.shiftKey?"cell"===c?s(t,n,l._select_lastCell||null):i(t,c,n,l._select_lastCell?l._select_lastCell[c]:null):t[c](n).select(!r))}function u(e){return e.id.replace(/[^a-zA-Z0-9\-\_]/g,"-")}t.select={},t.select.version="1.7.0-dev",t.select.init=function(e){var s,c,n,o,a,i,r,d,u,f,m,h=e.settings()[0];h._select||(s=e.state.loaded(),c=function(t,l,s){if(null!==s&&void 0!==s.select){if(e.rows({selected:!0}).any()&&e.rows().deselect(),void 0!==s.select.rows&&e.rows(s.select.rows).select(),e.columns({selected:!0}).any()&&e.columns().deselect(),void 0!==s.select.columns&&e.columns(s.select.columns).select(),e.cells({selected:!0}).any()&&e.cells().deselect(),void 0!==s.select.cells)for(var c=0;c<s.select.cells.length;c++)e.cell(s.select.cells[c].row,s.select.cells[c].column).select();e.state.save()}},e.on("stateSaveParams",function(t,l,s){s.select={},s.select.rows=e.rows({selected:!0}).ids(!0).toArray(),s.select.columns=e.columns({selected:!0})[0],s.select.cells=e.cells({selected:!0})[0].map(function(t){return{row:e.row(t.row).id(!0),column:t.column}})}).on("stateLoadParams",c).one("init",function(){c(0,0,s)}),o=h.oInit.select,n=t.defaults.select,n=void 0===o?n:o,o="row",d=r=!(i=!(a="api")),u="td, th",m=!(f="selected"),h._select={},!0===n?(a="os",m=!0):"string"==typeof n?(a=n,m=!0):l.isPlainObject(n)&&(void 0!==n.blurable&&(i=n.blurable),void 0!==n.toggleable&&(r=n.toggleable),void 0!==n.info&&(d=n.info),void 0!==n.items&&(o=n.items),a=void 0!==n.style?n.style:"os",m=!0,void 0!==n.selector&&(u=n.selector),void 0!==n.className&&(f=n.className)),e.select.selector(u),e.select.items(o),e.select.style(a),e.select.blurable(i),e.select.toggleable(r),e.select.info(d),h._select.className=f,l.fn.dataTable.ext.order["select-checkbox"]=function(e,t){return this.api().column(t,{order:"index"}).nodes().map(function(t){return"row"===e._select.items?l(t).parent().hasClass(e._select.className):"cell"===e._select.items&&l(t).hasClass(e._select.className)})},!m&&l(e.table().node()).hasClass("selectable")&&e.select.style("os"))},l.each([{type:"row",prop:"aoData"},{type:"column",prop:"aoColumns"}],function(e,l){t.ext.selector[l.type].push(function(e,t,s){var c,n=t.selected,o=[];if(!0!==n&&!1!==n)return s;for(var a=0,i=s.length;a<i;a++)c=e[l.prop][s[a]],(!0===n&&!0===c._select_selected||!1===n&&!c._select_selected)&&o.push(s[a]);return o})}),t.ext.selector.cell.push(function(e,t,l){var s,c=t.selected,n=[];if(void 0===c)return l;for(var o=0,a=l.length;o<a;o++)s=e.aoData[l[o].row],(!0!==c||!s._selected_cells||!0!==s._selected_cells[l[o].column])&&(!1!==c||s._selected_cells&&s._selected_cells[l[o].column])||n.push(l[o]);return n});var f=t.Api.register,m=t.Api.registerPlural;function h(e,t){return function(l){return l.i18n("buttons."+e,t)}}function _(e){return"draw.dt.DT"+(e=e._eventNamespace)+" select.dt.DT"+e+" deselect.dt.DT"+e}f("select()",function(){return this.iterator("table",function(e){t.select.init(new t.Api(e))})}),f("select.blurable()",function(e){return void 0===e?this.context[0]._select.blurable:this.iterator("table",function(t){t._select.blurable=e})}),f("select.toggleable()",function(e){return void 0===e?this.context[0]._select.toggleable:this.iterator("table",function(t){t._select.toggleable=e})}),f("select.info()",function(e){return void 0===e?this.context[0]._select.info:this.iterator("table",function(t){t._select.info=e})}),f("select.items()",function(e){return void 0===e?this.context[0]._select.items:this.iterator("table",function(l){l._select.items=e,o(new t.Api(l),"selectItems",[e])})}),f("select.style()",function(e){return void 0===e?this.context[0]._select.style:this.iterator("table",function(l){l._select||t.select.init(new t.Api(l)),l._select_init||a(l),l._select.style=e;var s=new t.Api(l);c(s),"api"!==e&&n(s),o(new t.Api(l),"selectStyle",[e])})}),f("select.selector()",function(e){return void 0===e?this.context[0]._select.selector:this.iterator("table",function(l){c(new t.Api(l)),l._select.selector=e,"api"!==l._select.style&&n(new t.Api(l))})}),m("rows().select()","row().select()",function(e){var t=this;return!1===e?this.deselect():(this.iterator("row",function(e,t){r(e),e.aoData[t]._select_selected=!0,l(e.aoData[t].nTr).addClass(e._select.className)}),this.iterator("table",function(e,l){o(t,"select",["row",t[l]],!0)}),this)}),f("row().selected()",function(){var e=this.context[0];return!!(e&&this.length&&e.aoData[this[0]]&&e.aoData[this[0]]._select_selected)}),m("columns().select()","column().select()",function(e){var s=this;return!1===e?this.deselect():(this.iterator("column",function(e,s){r(e),e.aoColumns[s]._select_selected=!0,s=new t.Api(e).column(s),l(s.header()).addClass(e._select.className),l(s.footer()).addClass(e._select.className),s.nodes().to$().addClass(e._select.className)}),this.iterator("table",function(e,t){o(s,"select",["column",s[t]],!0)}),this)}),f("column().selected()",function(){var e=this.context[0];return!!(e&&this.length&&e.aoColumns[this[0]]&&e.aoColumns[this[0]]._select_selected)}),m("cells().select()","cell().select()",function(e){var t=this;return!1===e?this.deselect():(this.iterator("cell",function(e,t,s){r(e),void 0===(t=e.aoData[t])._selected_cells&&(t._selected_cells=[]),t._selected_cells[s]=!0,t.anCells&&l(t.anCells[s]).addClass(e._select.className)}),this.iterator("table",function(e,l){o(t,"select",["cell",t.cells(t[l]).indexes().toArray()],!0)}),this)}),f("cell().selected()",function(){var e=this.context[0];return!!(e&&this.length&&(e=e.aoData[this[0][0].row])&&e._selected_cells&&e._selected_cells[this[0][0].column])}),m("rows().deselect()","row().deselect()",function(){var e=this;return this.iterator("row",function(e,t){e.aoData[t]._select_selected=!1,e._select_lastCell=null,l(e.aoData[t].nTr).removeClass(e._select.className)}),this.iterator("table",function(t,l){o(e,"deselect",["row",e[l]],!0)}),this}),m("columns().deselect()","column().deselect()",function(){var e=this;return this.iterator("column",function(e,s){e.aoColumns[s]._select_selected=!1;var c=new t.Api(e),n=c.column(s);l(n.header()).removeClass(e._select.className),l(n.footer()).removeClass(e._select.className),c.cells(null,s).indexes().each(function(t){var s=e.aoData[t.row],c=s._selected_cells;!s.anCells||c&&c[t.column]||l(s.anCells[t.column]).removeClass(e._select.className)})}),this.iterator("table",function(t,l){o(e,"deselect",["column",e[l]],!0)}),this}),m("cells().deselect()","cell().deselect()",function(){var e=this;return this.iterator("cell",function(e,t,s){void 0!==(t=e.aoData[t])._selected_cells&&(t._selected_cells[s]=!1),t.anCells&&!e.aoColumns[s]._select_selected&&l(t.anCells[s]).removeClass(e._select.className)}),this.iterator("table",function(t,l){o(e,"deselect",["cell",e[l]],!0)}),this});var v=0;l.extend(t.ext.buttons,{selected:{text:h("selected","Selected"),className:"buttons-selected",limitTo:["rows","columns","cells"],init:function(e,t,s){var c=this;s._eventNamespace=".select"+v++,e.on(_(s),function(){c.enable(function(e,t){return!(-1===l.inArray("rows",t.limitTo)||!e.rows({selected:!0}).any())||!(-1===l.inArray("columns",t.limitTo)||!e.columns({selected:!0}).any())||!(-1===l.inArray("cells",t.limitTo)||!e.cells({selected:!0}).any())}(e,s))}),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectedSingle:{text:h("selectedSingle","Selected single"),className:"buttons-selected-single",init:function(e,t,l){var s=this;l._eventNamespace=".select"+v++,e.on(_(l),function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;s.enable(1===t)}),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},selectAll:{text:h("selectAll","Select all"),className:"buttons-select-all",action:function(e,t,l,s){var c=this.select.items(),n=s.selectorModifier;(n?("function"==typeof n&&(n=n.call(t,e,t,l,s)),this[c+"s"](n)):this[c+"s"]()).select()}},selectNone:{text:h("selectNone","Deselect all"),className:"buttons-select-none",action:function(){r(this.settings()[0],!0)},init:function(e,t,l){var s=this;l._eventNamespace=".select"+v++,e.on(_(l),function(){var t=e.rows({selected:!0}).flatten().length+e.columns({selected:!0}).flatten().length+e.cells({selected:!0}).flatten().length;s.enable(0<t)}),this.disable()},destroy:function(e,t,l){e.off(l._eventNamespace)}},showSelected:{text:h("showSelected","Show only selected"),className:"buttons-show-selected",action:function(e,l,s,c){var n;c._filter?(-1!==(n=t.ext.search.indexOf(c._filter))&&(t.ext.search.splice(n,1),c._filter=null),this.active(!1)):(c._filter=n=function(e,t,s){return e!==l.settings()[0]||e.aoData[s]._select_selected},t.ext.search.push(n),this.active(!0)),l.draw()}}}),l.each(["Row","Column","Cell"],function(e,l){var s=l.toLowerCase();t.ext.buttons["select"+l+"s"]={text:h("select"+l+"s","Select "+s+"s"),className:"buttons-select-"+s+"s",action:function(){this.select.items(s)},init:function(e){var t=this;e.on("selectItems.dt.DT",function(e,l,c){t.active(c===s)})}}}),l.fn.DataTable.select=t.select,l(document).on("preInit.dt.dtSelect",function(e,l){"dt"===e.namespace&&t.select.init(new t.Api(l))});export default t;